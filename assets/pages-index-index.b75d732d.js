import{_ as a,c as t,s,a as o,b as e,d as i,g as c,p as l,o as n,e as r,w as h,i as d,f,h as u,j as m,n as p,k as C,r as g,F as k,l as _,m as y,q as I,t as P,S as b}from"./index-cad6a867.js";const v=a({data:()=>({cameraPosition:"back",flashMode:"off",capturedImage:"",photoList:[],cameraContext:null}),computed:{flashIcon(){return"on"===this.flashMode?"/static/flash-on.svg":"/static/flash-off.svg"}},onLoad(){this.initCamera(),this.loadPhotoHistory()},onShow(){this.loadPhotoHistory()},methods:{initCamera(){this.cameraContext=t()},onCameraInit(a){},onCameraError(a){s({title:"相机启动失败，请检查权限设置",icon:"none",duration:3e3})},onScanCode(a){},takePhoto(){this.cameraContext||this.initCamera(),this.cameraContext.takePhoto({quality:"high",success:a=>{this.capturedImage=a.tempImagePath},fail:a=>{s({title:"拍照失败，请重试",icon:"none"})}})},switchCamera(){this.cameraPosition="back"===this.cameraPosition?"front":"back"},toggleFlash(){this.flashMode="off"===this.flashMode?"on":"off"},retakePhoto(){this.capturedImage=""},savePhoto(){this.capturedImage&&o({filePath:this.capturedImage,success:()=>{s({title:"保存成功",icon:"success"}),this.addToHistory(this.capturedImage),this.capturedImage=""},fail:a=>{a.errMsg.includes("auth")?e({title:"权限不足",content:"请在设置中开启保存到相册的权限",showCancel:!1}):s({title:"保存失败",icon:"none"})}})},addToHistory(a){this.photoList.unshift(a),this.photoList.length>10&&(this.photoList=this.photoList.slice(0,10)),i("photoHistory",this.photoList)},loadPhotoHistory(){try{const a=c("photoHistory");a&&Array.isArray(a)&&(this.photoList=a)}catch(a){}},previewPhoto(a){l({urls:[a],current:a})}}},[["render",function(a,t,s,o,e,i){const c=_,l=d,v=y,w=I,L=P,x=b;return n(),r(l,{class:"container"},{default:h(()=>[f(l,{class:"header"},{default:h(()=>[f(c,{class:"title"},{default:h(()=>[u("相机拍照")]),_:1})]),_:1}),m(" 相机组件 "),e.capturedImage?m("v-if",!0):(n(),r(l,{key:0,class:"camera-container"},{default:h(()=>[f(v,{class:"camera","device-position":"back",flash:"off",onError:i.onCameraError,onInitdone:i.onCameraInit,onScancode:i.onScanCode},{default:h(()=>[f(l,{class:"h5-camera-overlay"},{default:h(()=>[f(l,{class:"h5-camera-controls"},{default:h(()=>[f(l,{class:"h5-btn-group"},{default:h(()=>[f(l,{class:"h5-camera-btn h5-switch-btn",onClick:i.switchCamera},{default:h(()=>[f(l,{class:"switch-icon"})]),_:1},8,["onClick"]),f(l,{class:"h5-camera-btn h5-capture-btn",onClick:i.takePhoto},{default:h(()=>[f(l,{class:"capture-inner"})]),_:1},8,["onClick"]),f(l,{class:"h5-camera-btn h5-flash-btn",onClick:i.toggleFlash},{default:h(()=>[f(l,{class:p("on"===e.flashMode?"flash-on-icon":"flash-off-icon")},null,8,["class"])]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onError","onInitdone","onScancode"])]),_:1})),m(" 图片预览 "),e.capturedImage?(n(),r(l,{key:1,class:"preview-container"},{default:h(()=>[f(w,{src:e.capturedImage,class:"preview-image",mode:"aspectFit"},null,8,["src"]),f(l,{class:"preview-controls"},{default:h(()=>[f(L,{class:"btn btn-secondary",onClick:i.retakePhoto},{default:h(()=>[u("重新拍照")]),_:1},8,["onClick"]),f(L,{class:"btn btn-success",onClick:i.savePhoto},{default:h(()=>[u("保存照片")]),_:1},8,["onClick"])]),_:1})]),_:1})):m("v-if",!0),m(" 拍照历史 "),e.photoList.length>0&&!e.capturedImage?(n(),r(l,{key:2,class:"photo-history"},{default:h(()=>[f(l,{class:"history-title"},{default:h(()=>[u("拍照历史")]),_:1}),f(x,{class:"history-scroll","scroll-x":"true"},{default:h(()=>[(n(!0),C(k,null,g(e.photoList,(a,t)=>(n(),r(l,{class:"history-item",key:t,onClick:t=>i.previewPhoto(a)},{default:h(()=>[f(w,{src:a,class:"history-image",mode:"aspectFill"},null,8,["src"])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):m("v-if",!0),m(" 提示信息 "),e.capturedImage?m("v-if",!0):(n(),r(l,{key:3,class:"tips"},{default:h(()=>[f(c,{class:"tips-text"},{default:h(()=>[u("点击下方圆形按钮进行拍照")]),_:1})]),_:1}))]),_:1})}],["__scopeId","data-v-9878684e"]]);export{v as default};
